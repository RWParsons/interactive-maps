<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Asynchronous loading and distracting your user | Interactive maps with leaflet</title>
  <meta name="description" content="This is a guide on how to make interactive maps for shiny apps with leaflet. It covers the methods used to developed the iTRAQI app." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Asynchronous loading and distracting your user | Interactive maps with leaflet" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a guide on how to make interactive maps for shiny apps with leaflet. It covers the methods used to developed the iTRAQI app." />
  <meta name="github-repo" content="RWParsons/interactive-maps" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Asynchronous loading and distracting your user | Interactive maps with leaflet" />
  
  <meta name="twitter:description" content="This is a guide on how to make interactive maps for shiny apps with leaflet. It covers the methods used to developed the iTRAQI app." />
  

<meta name="author" content="Rex Parsons" />


<meta name="date" content="2022-08-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="iTRAQI-tricks.html"/>
<link rel="next" href="leaflet-colours.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Interactive maps</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#suggested-citation"><i class="fa fa-check"></i>Suggested citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#author-affiliations"><i class="fa fa-check"></i>Author affiliations</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#leaflet-layers"><i class="fa fa-check"></i><b>1.1</b> leaflet layers</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="building.html"><a href="building.html"><i class="fa fa-check"></i><b>2</b> Creating the layers</a>
<ul>
<li class="chapter" data-level="2.1" data-path="building.html"><a href="building.html#kriging"><i class="fa fa-check"></i><b>2.1</b> Kriging</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="building.html"><a href="building.html#data"><i class="fa fa-check"></i><b>2.1.1</b> Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="building.html"><a href="building.html#making-a-grid-of-values-for-interpolation"><i class="fa fa-check"></i><b>2.1.2</b> Making a grid of values for interpolation</a></li>
<li class="chapter" data-level="2.1.3" data-path="building.html"><a href="building.html#kriging-finally"><i class="fa fa-check"></i><b>2.1.3</b> Kriging (finally)</a></li>
<li class="chapter" data-level="2.1.4" data-path="building.html"><a href="building.html#making-rasters"><i class="fa fa-check"></i><b>2.1.4</b> Making rasters</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="building.html"><a href="building.html#polygons"><i class="fa fa-check"></i><b>2.2</b> Polygons</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="building.html"><a href="building.html#dissolving-polygons-to-get-sa2s-and-sa3s"><i class="fa fa-check"></i><b>2.2.1</b> Dissolving polygons to get SA2s and SA3s</a></li>
<li class="chapter" data-level="2.2.2" data-path="building.html"><a href="building.html#simplifying-polygons-to-reduce-rendering-time-with-leaflet"><i class="fa fa-check"></i><b>2.2.2</b> Simplifying polygons to reduce rendering time with leaflet</a></li>
<li class="chapter" data-level="2.2.3" data-path="building.html"><a href="building.html#spatial-joins-and-aggregations"><i class="fa fa-check"></i><b>2.2.3</b> Spatial joins and aggregations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="shiny-intro.html"><a href="shiny-intro.html"><i class="fa fa-check"></i><b>3</b> An app with a map</a>
<ul>
<li class="chapter" data-level="3.1" data-path="shiny-intro.html"><a href="shiny-intro.html#a-bare-bones-shiny-app"><i class="fa fa-check"></i><b>3.1</b> A bare bones shiny app</a></li>
<li class="chapter" data-level="3.2" data-path="shiny-intro.html"><a href="shiny-intro.html#leaflet-maps-in-shiny"><i class="fa fa-check"></i><b>3.2</b> Leaflet maps in shiny</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="shiny-intro.html"><a href="shiny-intro.html#filling-the-space"><i class="fa fa-check"></i><b>3.2.1</b> Filling the space</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="shiny-intro.html"><a href="shiny-intro.html#leaflet-vs-shiny-interactivity"><i class="fa fa-check"></i><b>3.3</b> Leaflet vs shiny interactivity</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="iTRAQI-tricks.html"><a href="iTRAQI-tricks.html"><i class="fa fa-check"></i><b>4</b> iTRAQI tricks</a></li>
<li class="chapter" data-level="5" data-path="async-loading.html"><a href="async-loading.html"><i class="fa fa-check"></i><b>5</b> Asynchronous loading and distracting your user</a>
<ul>
<li class="chapter" data-level="5.1" data-path="async-loading.html"><a href="async-loading.html#distracting-your-user"><i class="fa fa-check"></i><b>5.1</b> Distracting your user</a></li>
<li class="chapter" data-level="5.2" data-path="async-loading.html"><a href="async-loading.html#asynchronous-loading"><i class="fa fa-check"></i><b>5.2</b> Asynchronous loading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="leaflet-colours.html"><a href="leaflet-colours.html"><i class="fa fa-check"></i><b>6</b> Colours with leaflet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="leaflet-colours.html"><a href="leaflet-colours.html#colour-scales-with-leaflet"><i class="fa fa-check"></i><b>6.1</b> Colour scales with leaflet</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="leaflet-colours.html"><a href="leaflet-colours.html#palettes-for-discrete-variables"><i class="fa fa-check"></i><b>6.1.1</b> Palettes for discrete variables</a></li>
<li class="chapter" data-level="6.1.2" data-path="leaflet-colours.html"><a href="leaflet-colours.html#palettes-for-continuous-variables"><i class="fa fa-check"></i><b>6.1.2</b> Palettes for continuous variables</a></li>
<li class="chapter" data-level="6.1.3" data-path="leaflet-colours.html"><a href="leaflet-colours.html#a-mix-of-continuous-and-discrete-colour-scales"><i class="fa fa-check"></i><b>6.1.3</b> A mix of continuous and discrete colour scales</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="leaflet-colours.html"><a href="leaflet-colours.html#legends-with-leaflet"><i class="fa fa-check"></i><b>6.2</b> Legends with leaflet</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html"><i class="fa fa-check"></i><b>7</b> Using a leaflet palette in ggplot</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html#basic-scatterplot-with-ggplot2"><i class="fa fa-check"></i><b>7.1</b> Basic scatterplot with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="7.2" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html#colouring-the-scatterplot-with-the-itraqi-colours"><i class="fa fa-check"></i><b>7.2</b> Colouring the scatterplot with the iTRAQI colours</a></li>
<li class="chapter" data-level="7.3" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html#colouring-the-scatterplot-with-our-custom-palettes-colours"><i class="fa fa-check"></i><b>7.3</b> Colouring the scatterplot with our custom-palette’s colours</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="shiny-colours.html"><a href="shiny-colours.html"><i class="fa fa-check"></i><b>8</b> Getting your map layers and colours communicating</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive maps with leaflet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="async-loading" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Asynchronous loading and distracting your user<a href="async-loading.html#async-loading" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="distracting-your-user" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Distracting your user<a href="async-loading.html#distracting-your-user" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We made the following app in the last section of chapter <a href="shiny-intro.html#shiny-intro">3</a> except we only used SA2 polygons. In the iTRAQI app, we use both SA1s and SA2s - this means a lot more detail, many more polygons, and a slower load time. The following code loads both SA1s and SA2s - note how long it takes to run by either copy-pasting the code or running the first <code>runGithub</code> line. (Also, appreciate that a shiny server may load it even slower than the computer, especially if that server has many concurrent users!)</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="async-loading.html#cb55-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">&quot;RWParsons/interactive-maps&quot;</span>, <span class="at">subdir=</span><span class="st">&quot;input/apps/05-async-load-1/&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="async-loading.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb56-2"><a href="async-loading.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb56-3"><a href="async-loading.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb56-4"><a href="async-loading.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb56-5"><a href="async-loading.html#cb56-5" aria-hidden="true" tabindex="-1"></a>input_dir <span class="ot">&lt;-</span> <span class="st">&quot;./input&quot;</span></span>
<span id="cb56-6"><a href="async-loading.html#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="async-loading.html#cb56-7" aria-hidden="true" tabindex="-1"></a>sa_polygons <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(input_dir, <span class="st">&quot;stacked_SA1_and_SA2_polygons_year2016_simplified.rds&quot;</span>))</span>
<span id="cb56-8"><a href="async-loading.html#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="async-loading.html#cb56-9" aria-hidden="true" tabindex="-1"></a>towns <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(input_dir, <span class="st">&quot;df_towns.csv&quot;</span>)) </span>
<span id="cb56-10"><a href="async-loading.html#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="async-loading.html#cb56-11" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">navbarPage</span>(</span>
<span id="cb56-12"><a href="async-loading.html#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;App-with-a-map&quot;</span>, <span class="at">id=</span><span class="st">&quot;nav&quot;</span>,</span>
<span id="cb56-13"><a href="async-loading.html#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabPanel</span>(</span>
<span id="cb56-14"><a href="async-loading.html#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Map&quot;</span>,</span>
<span id="cb56-15"><a href="async-loading.html#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">div</span>(</span>
<span id="cb56-16"><a href="async-loading.html#cb56-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">class=</span><span class="st">&quot;outer&quot;</span>,</span>
<span id="cb56-17"><a href="async-loading.html#cb56-17" aria-hidden="true" tabindex="-1"></a>        tags<span class="sc">$</span><span class="fu">head</span>(</span>
<span id="cb56-18"><a href="async-loading.html#cb56-18" aria-hidden="true" tabindex="-1"></a>          tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">&quot;</span></span>
<span id="cb56-19"><a href="async-loading.html#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="st">            div.outer {</span></span>
<span id="cb56-20"><a href="async-loading.html#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="st">              position: fixed;</span></span>
<span id="cb56-21"><a href="async-loading.html#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="st">              top: 41px;</span></span>
<span id="cb56-22"><a href="async-loading.html#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="st">              left: 0;</span></span>
<span id="cb56-23"><a href="async-loading.html#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="st">              right: 0;</span></span>
<span id="cb56-24"><a href="async-loading.html#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="st">              bottom: 0;</span></span>
<span id="cb56-25"><a href="async-loading.html#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="st">              overflow: hidden;</span></span>
<span id="cb56-26"><a href="async-loading.html#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="st">              padding: 0;</span></span>
<span id="cb56-27"><a href="async-loading.html#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb56-28"><a href="async-loading.html#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;</span></span>
<span id="cb56-29"><a href="async-loading.html#cb56-29" aria-hidden="true" tabindex="-1"></a>          ))</span>
<span id="cb56-30"><a href="async-loading.html#cb56-30" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb56-31"><a href="async-loading.html#cb56-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">leafletOutput</span>(<span class="st">&#39;map&#39;</span>, <span class="at">height=</span><span class="st">&quot;100%&quot;</span>, <span class="at">width=</span><span class="st">&quot;100%&quot;</span>)</span>
<span id="cb56-32"><a href="async-loading.html#cb56-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-33"><a href="async-loading.html#cb56-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-34"><a href="async-loading.html#cb56-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-35"><a href="async-loading.html#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="async-loading.html#cb56-36" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb56-37"><a href="async-loading.html#cb56-37" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>map <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb56-38"><a href="async-loading.html#cb56-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-39"><a href="async-loading.html#cb56-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-40"><a href="async-loading.html#cb56-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addPolygons</span>(</span>
<span id="cb56-41"><a href="async-loading.html#cb56-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>sa_polygons,</span>
<span id="cb56-42"><a href="async-loading.html#cb56-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillColor=</span><span class="st">&quot;Orange&quot;</span>,</span>
<span id="cb56-43"><a href="async-loading.html#cb56-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb56-44"><a href="async-loading.html#cb56-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight=</span><span class="dv">1</span>,</span>
<span id="cb56-45"><a href="async-loading.html#cb56-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span><span class="st">&quot;Polygons&quot;</span></span>
<span id="cb56-46"><a href="async-loading.html#cb56-46" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb56-47"><a href="async-loading.html#cb56-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addCircleMarkers</span>(</span>
<span id="cb56-48"><a href="async-loading.html#cb56-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">lng=</span>towns<span class="sc">$</span>x,</span>
<span id="cb56-49"><a href="async-loading.html#cb56-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">lat=</span>towns<span class="sc">$</span>y,</span>
<span id="cb56-50"><a href="async-loading.html#cb56-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">popup=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;&lt;b&gt;Location:&lt;/b&gt; {towns$acute_care_centre}&quot;</span>),</span>
<span id="cb56-51"><a href="async-loading.html#cb56-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">radius=</span><span class="dv">2</span>, </span>
<span id="cb56-52"><a href="async-loading.html#cb56-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillOpacity=</span><span class="dv">0</span>,</span>
<span id="cb56-53"><a href="async-loading.html#cb56-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span><span class="st">&quot;Towns&quot;</span></span>
<span id="cb56-54"><a href="async-loading.html#cb56-54" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb56-55"><a href="async-loading.html#cb56-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addLayersControl</span>(</span>
<span id="cb56-56"><a href="async-loading.html#cb56-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">position=</span><span class="st">&quot;topright&quot;</span>,</span>
<span id="cb56-57"><a href="async-loading.html#cb56-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">baseGroups=</span><span class="fu">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Polygons&quot;</span>),</span>
<span id="cb56-58"><a href="async-loading.html#cb56-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">overlayGroups=</span><span class="fu">c</span>(<span class="st">&quot;Towns&quot;</span>),</span>
<span id="cb56-59"><a href="async-loading.html#cb56-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">options=</span><span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-60"><a href="async-loading.html#cb56-60" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb56-61"><a href="async-loading.html#cb56-61" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb56-62"><a href="async-loading.html#cb56-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-63"><a href="async-loading.html#cb56-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-64"><a href="async-loading.html#cb56-64" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<p>There are a couple things that we can do to ensure our user doesn’t get bored and close the app.
The first (and easiest) is to show a fun fact, loading spinner or some other form of brief entertainment. The second option is to load the map asynchronously: we can load part of the map and allow the user access to some of the functionality, and defer loading the computationally expensive parts a bit. For the iTRAQI app, we use both a fun fact/gif/image and asynchronous loading.</p>
<p>To show content, we will add a panel which displays over the app, and once the map is created, we will hide it.</p>
<p>To do this, we add an <code>absolutePanel()</code> to our UI which has the message and image that we want to display. Here, I use a function, <code>get_display()</code> which gets a random message from those in <code>loading_panel_displays</code>. I format the messages using HTML and therefore need to wrap the display with <code>HTML()</code> when presenting it in the<code>absolutePanel</code>. Images can be added - here I have used some online but if you have images in the <code>www/</code> directory of your shiny app, you can use those instead.
To hide the panel once the map is created, we need to use <code>{shinyjs}</code>. To allow us to use it’s functions on the UI, we need to include <code>useShinyjs()</code> there. Once the map is made in <code>renderLeafet()</code> on the server side, I hide the absolute panel with <code>shinyjs::hide("loadingScreen")</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="async-loading.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb57-2"><a href="async-loading.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb57-3"><a href="async-loading.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb57-4"><a href="async-loading.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb57-5"><a href="async-loading.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb57-6"><a href="async-loading.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shinyjs)</span>
<span id="cb57-7"><a href="async-loading.html#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="async-loading.html#cb57-8" aria-hidden="true" tabindex="-1"></a>input_dir <span class="ot">&lt;-</span> <span class="st">&quot;./input&quot;</span></span>
<span id="cb57-9"><a href="async-loading.html#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="async-loading.html#cb57-10" aria-hidden="true" tabindex="-1"></a>sa_polygons <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(input_dir, <span class="st">&quot;stacked_SA1_and_SA2_polygons_year2016_simplified.rds&quot;</span>))</span>
<span id="cb57-11"><a href="async-loading.html#cb57-11" aria-hidden="true" tabindex="-1"></a>towns <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(input_dir, <span class="st">&quot;df_towns.csv&quot;</span>)) </span>
<span id="cb57-12"><a href="async-loading.html#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="async-loading.html#cb57-13" aria-hidden="true" tabindex="-1"></a>loading_panel_displays <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb57-14"><a href="async-loading.html#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb57-15"><a href="async-loading.html#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb57-16"><a href="async-loading.html#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&lt;h2&gt;First fun fact text!&lt;/h2&gt;&quot;</span>,</span>
<span id="cb57-17"><a href="async-loading.html#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;img src=&quot;https://www.r-project.org/logo/Rlogo.png&quot; alt=&quot;R&quot; style=&quot;width:200px&quot;&gt;&#39;</span></span>
<span id="cb57-18"><a href="async-loading.html#cb57-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb57-19"><a href="async-loading.html#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb57-20"><a href="async-loading.html#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb57-21"><a href="async-loading.html#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&lt;h2&gt;Second fun fact text!&lt;/h2&gt;&quot;</span>,</span>
<span id="cb57-22"><a href="async-loading.html#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;img src=&quot;https://www.rstudio.com/assets/img/logo.svg&quot; alt=&quot;dog-1&quot; style=&quot;width:200px;&quot;&gt;&#39;</span></span>
<span id="cb57-23"><a href="async-loading.html#cb57-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-24"><a href="async-loading.html#cb57-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-25"><a href="async-loading.html#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="async-loading.html#cb57-26" aria-hidden="true" tabindex="-1"></a>get_display <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb57-27"><a href="async-loading.html#cb57-27" aria-hidden="true" tabindex="-1"></a>  loading_panel_displays[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loading_panel_displays), <span class="at">size=</span><span class="dv">1</span>)]</span>
<span id="cb57-28"><a href="async-loading.html#cb57-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-29"><a href="async-loading.html#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="async-loading.html#cb57-30" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">navbarPage</span>(</span>
<span id="cb57-31"><a href="async-loading.html#cb57-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;App-with-a-map&quot;</span>, <span class="at">id=</span><span class="st">&quot;nav&quot;</span>,</span>
<span id="cb57-32"><a href="async-loading.html#cb57-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabPanel</span>(</span>
<span id="cb57-33"><a href="async-loading.html#cb57-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Map&quot;</span>,</span>
<span id="cb57-34"><a href="async-loading.html#cb57-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">useShinyjs</span>(),</span>
<span id="cb57-35"><a href="async-loading.html#cb57-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">div</span>(</span>
<span id="cb57-36"><a href="async-loading.html#cb57-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">class=</span><span class="st">&quot;outer&quot;</span>,</span>
<span id="cb57-37"><a href="async-loading.html#cb57-37" aria-hidden="true" tabindex="-1"></a>        tags<span class="sc">$</span><span class="fu">head</span>(</span>
<span id="cb57-38"><a href="async-loading.html#cb57-38" aria-hidden="true" tabindex="-1"></a>          tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">&quot;</span></span>
<span id="cb57-39"><a href="async-loading.html#cb57-39" aria-hidden="true" tabindex="-1"></a><span class="st">            div.outer {</span></span>
<span id="cb57-40"><a href="async-loading.html#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="st">              position: fixed;</span></span>
<span id="cb57-41"><a href="async-loading.html#cb57-41" aria-hidden="true" tabindex="-1"></a><span class="st">              top: 41px;</span></span>
<span id="cb57-42"><a href="async-loading.html#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="st">              left: 0;</span></span>
<span id="cb57-43"><a href="async-loading.html#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="st">              right: 0;</span></span>
<span id="cb57-44"><a href="async-loading.html#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="st">              bottom: 0;</span></span>
<span id="cb57-45"><a href="async-loading.html#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="st">              overflow: hidden;</span></span>
<span id="cb57-46"><a href="async-loading.html#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="st">              padding: 0;</span></span>
<span id="cb57-47"><a href="async-loading.html#cb57-47" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb57-48"><a href="async-loading.html#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;</span></span>
<span id="cb57-49"><a href="async-loading.html#cb57-49" aria-hidden="true" tabindex="-1"></a>          ))</span>
<span id="cb57-50"><a href="async-loading.html#cb57-50" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb57-51"><a href="async-loading.html#cb57-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">leafletOutput</span>(<span class="st">&#39;map&#39;</span>, <span class="at">height=</span><span class="st">&quot;100%&quot;</span>, <span class="at">width=</span><span class="st">&quot;100%&quot;</span>),</span>
<span id="cb57-52"><a href="async-loading.html#cb57-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">absolutePanel</span>(</span>
<span id="cb57-53"><a href="async-loading.html#cb57-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="st">&quot;loadingScreen&quot;</span>, <span class="at">class =</span> <span class="st">&quot;panel panel-default&quot;</span>, </span>
<span id="cb57-54"><a href="async-loading.html#cb57-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="at">draggable =</span> <span class="cn">TRUE</span>, </span>
<span id="cb57-55"><a href="async-loading.html#cb57-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">left =</span> <span class="st">&quot;50%&quot;</span>, <span class="at">right =</span> <span class="st">&quot;50%&quot;</span>, <span class="at">bottom =</span> <span class="st">&quot;50%&quot;</span>, <span class="at">top=</span><span class="st">&quot;50%&quot;</span>,</span>
<span id="cb57-56"><a href="async-loading.html#cb57-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">200</span>,</span>
<span id="cb57-57"><a href="async-loading.html#cb57-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">HTML</span>(<span class="fu">get_display</span>())</span>
<span id="cb57-58"><a href="async-loading.html#cb57-58" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb57-59"><a href="async-loading.html#cb57-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-60"><a href="async-loading.html#cb57-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-61"><a href="async-loading.html#cb57-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-62"><a href="async-loading.html#cb57-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-63"><a href="async-loading.html#cb57-63" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb57-64"><a href="async-loading.html#cb57-64" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>map <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb57-65"><a href="async-loading.html#cb57-65" aria-hidden="true" tabindex="-1"></a>    map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-66"><a href="async-loading.html#cb57-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-67"><a href="async-loading.html#cb57-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addPolygons</span>(</span>
<span id="cb57-68"><a href="async-loading.html#cb57-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>sa_polygons,</span>
<span id="cb57-69"><a href="async-loading.html#cb57-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillColor=</span><span class="st">&quot;Orange&quot;</span>,</span>
<span id="cb57-70"><a href="async-loading.html#cb57-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb57-71"><a href="async-loading.html#cb57-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight=</span><span class="dv">1</span>,</span>
<span id="cb57-72"><a href="async-loading.html#cb57-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span><span class="st">&quot;Polygons&quot;</span></span>
<span id="cb57-73"><a href="async-loading.html#cb57-73" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb57-74"><a href="async-loading.html#cb57-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addCircleMarkers</span>(</span>
<span id="cb57-75"><a href="async-loading.html#cb57-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">lng=</span>towns<span class="sc">$</span>x,</span>
<span id="cb57-76"><a href="async-loading.html#cb57-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">lat=</span>towns<span class="sc">$</span>y,</span>
<span id="cb57-77"><a href="async-loading.html#cb57-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">popup=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;&lt;b&gt;Location:&lt;/b&gt; {towns$acute_care_centre}&quot;</span>),</span>
<span id="cb57-78"><a href="async-loading.html#cb57-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">radius=</span><span class="dv">2</span>, </span>
<span id="cb57-79"><a href="async-loading.html#cb57-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillOpacity=</span><span class="dv">0</span>,</span>
<span id="cb57-80"><a href="async-loading.html#cb57-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span><span class="st">&quot;Towns&quot;</span></span>
<span id="cb57-81"><a href="async-loading.html#cb57-81" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb57-82"><a href="async-loading.html#cb57-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addLayersControl</span>(</span>
<span id="cb57-83"><a href="async-loading.html#cb57-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">position=</span><span class="st">&quot;topright&quot;</span>,</span>
<span id="cb57-84"><a href="async-loading.html#cb57-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">baseGroups=</span><span class="fu">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Polygons&quot;</span>),</span>
<span id="cb57-85"><a href="async-loading.html#cb57-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">overlayGroups=</span><span class="fu">c</span>(<span class="st">&quot;Towns&quot;</span>),</span>
<span id="cb57-86"><a href="async-loading.html#cb57-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">options=</span><span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-87"><a href="async-loading.html#cb57-87" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb57-88"><a href="async-loading.html#cb57-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hide</span>(<span class="st">&quot;loadingScreen&quot;</span>)</span>
<span id="cb57-89"><a href="async-loading.html#cb57-89" aria-hidden="true" tabindex="-1"></a>    map</span>
<span id="cb57-90"><a href="async-loading.html#cb57-90" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb57-91"><a href="async-loading.html#cb57-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-92"><a href="async-loading.html#cb57-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-93"><a href="async-loading.html#cb57-93" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="async-loading.html#cb58-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">&quot;RWParsons/interactive-maps&quot;</span>, <span class="at">subdir=</span><span class="st">&quot;input/apps/06-async-load-2/&quot;</span>)</span></code></pre></div>
</div>
<div id="asynchronous-loading" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Asynchronous loading<a href="async-loading.html#asynchronous-loading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You might notice that there is still a delay between the loading screen disappearing and the map appearing. This is because there is still some time between when the map is rendered by the server and it being drawn for us to see.</p>
<p>Fortunately, we can make it faster to make and display the initial map if it (initially) lacks the detailed polygons.</p>
<p>To load the map asynchronously, we will first render and show a relatively simple map - just the base tiles and the towns. Then, once that’s shown to the user, we will add the polygons to the now available map with <code>leafletProxy()</code>.</p>
<p>To trigger this action, we will use a callback. <code>onFlushed()</code> can be used to register functions which occur after shiny flushes the reactive system. In our case, we can use this to trigger the adding of polygons to our map once the shiny system (with the first, simple map) is “flushed”.</p>
<p>Since in the iTRAQI app, we have more than one map, we trigger a function with <code>onFlushed()</code> that can trigger all maps, but only those maps on the current tab are actually have the content added. Since we need to check whether (1) we have triggered “to_load” the map, (2) whether the “map” exists to add content to, and (3) whether the map is already completed or not (“map_complete”), we store these in reactive values. These are values which can be updated by our function (triggered by <code>onFlushed()</code>) and observed to trigger the addition of map content. Every time content is flushed, the “to_load” value is updated, this triggers an observe event to add content to the map. If this finds that the map doesn’t exist or it does and the additional content has already been added, it does nothing. If the map exists and it hasn’t had the polygons added (<code>!is.null(rvs$map) &amp; map_complete==FALSE</code>), it adds them, and then updates the <code>map_complete</code> to be <code>TRUE</code> so that it won’t attempt to add the same content again.</p>
<p>The end result is that the initial map appears quickly and is interactive and the addition of the polygons happens in the background (hopefully before the user tries to display them). In this example, we hide the loading screen once we have added the polygons but if we are confident that the user is unlikely to try to show them within the first little bit since opening the app, we could move the <code>hide("loadingScreen")</code> back to the <code>renderLeafet()</code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="async-loading.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb59-2"><a href="async-loading.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb59-3"><a href="async-loading.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-4"><a href="async-loading.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb59-5"><a href="async-loading.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb59-6"><a href="async-loading.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shinyjs)</span>
<span id="cb59-7"><a href="async-loading.html#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="async-loading.html#cb59-8" aria-hidden="true" tabindex="-1"></a>input_dir <span class="ot">&lt;-</span> <span class="st">&quot;./input&quot;</span></span>
<span id="cb59-9"><a href="async-loading.html#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="async-loading.html#cb59-10" aria-hidden="true" tabindex="-1"></a>sa_polygons <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(input_dir, <span class="st">&quot;stacked_SA1_and_SA2_polygons_year2016_simplified.rds&quot;</span>))</span>
<span id="cb59-11"><a href="async-loading.html#cb59-11" aria-hidden="true" tabindex="-1"></a>towns <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(input_dir, <span class="st">&quot;df_towns.csv&quot;</span>)) </span>
<span id="cb59-12"><a href="async-loading.html#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="async-loading.html#cb59-13" aria-hidden="true" tabindex="-1"></a>loading_panel_displays <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb59-14"><a href="async-loading.html#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb59-15"><a href="async-loading.html#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb59-16"><a href="async-loading.html#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&lt;h2&gt;First fun fact text!&lt;/h2&gt;&quot;</span>,</span>
<span id="cb59-17"><a href="async-loading.html#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;img src=&quot;https://www.r-project.org/logo/Rlogo.png&quot; alt=&quot;R&quot; style=&quot;width:200px&quot;&gt;&#39;</span></span>
<span id="cb59-18"><a href="async-loading.html#cb59-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb59-19"><a href="async-loading.html#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb59-20"><a href="async-loading.html#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb59-21"><a href="async-loading.html#cb59-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&lt;h2&gt;Second fun fact text!&lt;/h2&gt;&quot;</span>,</span>
<span id="cb59-22"><a href="async-loading.html#cb59-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;img src=&quot;https://www.rstudio.com/assets/img/logo.svg&quot; alt=&quot;dog-1&quot; style=&quot;width:200px;&quot;&gt;&#39;</span></span>
<span id="cb59-23"><a href="async-loading.html#cb59-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-24"><a href="async-loading.html#cb59-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-25"><a href="async-loading.html#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="async-loading.html#cb59-26" aria-hidden="true" tabindex="-1"></a>get_display <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb59-27"><a href="async-loading.html#cb59-27" aria-hidden="true" tabindex="-1"></a>  loading_panel_displays[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loading_panel_displays), <span class="at">size=</span><span class="dv">1</span>)]</span>
<span id="cb59-28"><a href="async-loading.html#cb59-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-29"><a href="async-loading.html#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="async-loading.html#cb59-30" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">navbarPage</span>(</span>
<span id="cb59-31"><a href="async-loading.html#cb59-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;App-with-a-map&quot;</span>, <span class="at">id=</span><span class="st">&quot;nav&quot;</span>,</span>
<span id="cb59-32"><a href="async-loading.html#cb59-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabPanel</span>(</span>
<span id="cb59-33"><a href="async-loading.html#cb59-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Map&quot;</span>,</span>
<span id="cb59-34"><a href="async-loading.html#cb59-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">useShinyjs</span>(),</span>
<span id="cb59-35"><a href="async-loading.html#cb59-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">div</span>(</span>
<span id="cb59-36"><a href="async-loading.html#cb59-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">class=</span><span class="st">&quot;outer&quot;</span>,</span>
<span id="cb59-37"><a href="async-loading.html#cb59-37" aria-hidden="true" tabindex="-1"></a>        tags<span class="sc">$</span><span class="fu">head</span>(</span>
<span id="cb59-38"><a href="async-loading.html#cb59-38" aria-hidden="true" tabindex="-1"></a>          tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">&quot;</span></span>
<span id="cb59-39"><a href="async-loading.html#cb59-39" aria-hidden="true" tabindex="-1"></a><span class="st">            div.outer {</span></span>
<span id="cb59-40"><a href="async-loading.html#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="st">              position: fixed;</span></span>
<span id="cb59-41"><a href="async-loading.html#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="st">              top: 41px;</span></span>
<span id="cb59-42"><a href="async-loading.html#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="st">              left: 0;</span></span>
<span id="cb59-43"><a href="async-loading.html#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="st">              right: 0;</span></span>
<span id="cb59-44"><a href="async-loading.html#cb59-44" aria-hidden="true" tabindex="-1"></a><span class="st">              bottom: 0;</span></span>
<span id="cb59-45"><a href="async-loading.html#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="st">              overflow: hidden;</span></span>
<span id="cb59-46"><a href="async-loading.html#cb59-46" aria-hidden="true" tabindex="-1"></a><span class="st">              padding: 0;</span></span>
<span id="cb59-47"><a href="async-loading.html#cb59-47" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb59-48"><a href="async-loading.html#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;</span></span>
<span id="cb59-49"><a href="async-loading.html#cb59-49" aria-hidden="true" tabindex="-1"></a>          ))</span>
<span id="cb59-50"><a href="async-loading.html#cb59-50" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb59-51"><a href="async-loading.html#cb59-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">leafletOutput</span>(<span class="st">&#39;map&#39;</span>, <span class="at">height=</span><span class="st">&quot;100%&quot;</span>, <span class="at">width=</span><span class="st">&quot;100%&quot;</span>),</span>
<span id="cb59-52"><a href="async-loading.html#cb59-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">absolutePanel</span>(</span>
<span id="cb59-53"><a href="async-loading.html#cb59-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">top=</span><span class="dv">75</span>, <span class="at">left=</span><span class="dv">10</span>, </span>
<span id="cb59-54"><a href="async-loading.html#cb59-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">class =</span> <span class="st">&quot;panel panel-default&quot;</span>,</span>
<span id="cb59-55"><a href="async-loading.html#cb59-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">selectInput</span>(<span class="st">&#39;town_name&#39;</span>, <span class="st">&#39;Town Name&#39;</span>,</span>
<span id="cb59-56"><a href="async-loading.html#cb59-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&#39;None&#39;</span>, <span class="fu">sort</span>(towns<span class="sc">$</span>location)),</span>
<span id="cb59-57"><a href="async-loading.html#cb59-57" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> <span class="st">&quot;None&quot;</span>)</span>
<span id="cb59-58"><a href="async-loading.html#cb59-58" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb59-59"><a href="async-loading.html#cb59-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">absolutePanel</span>(</span>
<span id="cb59-60"><a href="async-loading.html#cb59-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="st">&quot;loadingScreen&quot;</span>, <span class="at">class =</span> <span class="st">&quot;panel panel-default&quot;</span>, </span>
<span id="cb59-61"><a href="async-loading.html#cb59-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="at">draggable =</span> <span class="cn">TRUE</span>, </span>
<span id="cb59-62"><a href="async-loading.html#cb59-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">left =</span> <span class="st">&quot;50%&quot;</span>, <span class="at">right =</span> <span class="st">&quot;50%&quot;</span>, <span class="at">bottom =</span> <span class="st">&quot;50%&quot;</span>, <span class="at">top=</span><span class="st">&quot;50%&quot;</span>,</span>
<span id="cb59-63"><a href="async-loading.html#cb59-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">200</span>,</span>
<span id="cb59-64"><a href="async-loading.html#cb59-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">HTML</span>(<span class="fu">get_display</span>())</span>
<span id="cb59-65"><a href="async-loading.html#cb59-65" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb59-66"><a href="async-loading.html#cb59-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-67"><a href="async-loading.html#cb59-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-68"><a href="async-loading.html#cb59-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-69"><a href="async-loading.html#cb59-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-70"><a href="async-loading.html#cb59-70" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb59-71"><a href="async-loading.html#cb59-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-72"><a href="async-loading.html#cb59-72" aria-hidden="true" tabindex="-1"></a>  rvs <span class="ot">&lt;-</span> <span class="fu">reactiveValues</span>(<span class="at">to_load=</span><span class="cn">NULL</span>, <span class="at">map=</span><span class="cn">NULL</span>, <span class="at">map_complete=</span><span class="cn">FALSE</span>)</span>
<span id="cb59-73"><a href="async-loading.html#cb59-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-74"><a href="async-loading.html#cb59-74" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb59-75"><a href="async-loading.html#cb59-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">isolate</span>(rvs<span class="sc">$</span>to_load))) rvs<span class="sc">$</span>to_load <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb59-76"><a href="async-loading.html#cb59-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">isolate</span>(rvs<span class="sc">$</span>to_load)) <span class="sc">&amp;</span> </span>
<span id="cb59-77"><a href="async-loading.html#cb59-77" aria-hidden="true" tabindex="-1"></a>       <span class="sc">!</span><span class="fu">isolate</span>(rvs<span class="sc">$</span>map_complete) <span class="sc">&amp;</span> </span>
<span id="cb59-78"><a href="async-loading.html#cb59-78" aria-hidden="true" tabindex="-1"></a>       <span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">isolate</span>(rvs<span class="sc">$</span>map))){</span>
<span id="cb59-79"><a href="async-loading.html#cb59-79" aria-hidden="true" tabindex="-1"></a>      rvs<span class="sc">$</span>to_load <span class="ot">&lt;-</span> <span class="fu">isolate</span>(rvs<span class="sc">$</span>to_load) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-80"><a href="async-loading.html#cb59-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-81"><a href="async-loading.html#cb59-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-82"><a href="async-loading.html#cb59-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-83"><a href="async-loading.html#cb59-83" aria-hidden="true" tabindex="-1"></a>  session<span class="sc">$</span><span class="fu">onFlushed</span>(f, <span class="at">once=</span><span class="cn">FALSE</span>)</span>
<span id="cb59-84"><a href="async-loading.html#cb59-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-85"><a href="async-loading.html#cb59-85" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>map <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb59-86"><a href="async-loading.html#cb59-86" aria-hidden="true" tabindex="-1"></a>    rvs<span class="sc">$</span>map <span class="ot">&lt;-</span> </span>
<span id="cb59-87"><a href="async-loading.html#cb59-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-88"><a href="async-loading.html#cb59-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-89"><a href="async-loading.html#cb59-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addCircleMarkers</span>(</span>
<span id="cb59-90"><a href="async-loading.html#cb59-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">lng=</span>towns<span class="sc">$</span>x,</span>
<span id="cb59-91"><a href="async-loading.html#cb59-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">lat=</span>towns<span class="sc">$</span>y,</span>
<span id="cb59-92"><a href="async-loading.html#cb59-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">popup=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;&lt;b&gt;Location:&lt;/b&gt; {towns$acute_care_centre}&quot;</span>),</span>
<span id="cb59-93"><a href="async-loading.html#cb59-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">radius=</span><span class="dv">2</span>, </span>
<span id="cb59-94"><a href="async-loading.html#cb59-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillOpacity=</span><span class="dv">0</span>,</span>
<span id="cb59-95"><a href="async-loading.html#cb59-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span><span class="st">&quot;Towns&quot;</span></span>
<span id="cb59-96"><a href="async-loading.html#cb59-96" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb59-97"><a href="async-loading.html#cb59-97" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addLayersControl</span>(</span>
<span id="cb59-98"><a href="async-loading.html#cb59-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">position=</span><span class="st">&quot;topright&quot;</span>,</span>
<span id="cb59-99"><a href="async-loading.html#cb59-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">baseGroups=</span><span class="fu">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Polygons&quot;</span>),</span>
<span id="cb59-100"><a href="async-loading.html#cb59-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">overlayGroups=</span><span class="fu">c</span>(<span class="st">&quot;Towns&quot;</span>),</span>
<span id="cb59-101"><a href="async-loading.html#cb59-101" aria-hidden="true" tabindex="-1"></a>        <span class="at">options=</span><span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-102"><a href="async-loading.html#cb59-102" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb59-103"><a href="async-loading.html#cb59-103" aria-hidden="true" tabindex="-1"></a>    rvs<span class="sc">$</span>map</span>
<span id="cb59-104"><a href="async-loading.html#cb59-104" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb59-105"><a href="async-loading.html#cb59-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-106"><a href="async-loading.html#cb59-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observeEvent</span>(rvs<span class="sc">$</span>to_load,{</span>
<span id="cb59-107"><a href="async-loading.html#cb59-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">isolate</span>(rvs<span class="sc">$</span>map)) <span class="sc">|</span> <span class="fu">isolate</span>(rvs<span class="sc">$</span>map_complete)) <span class="fu">return</span>()</span>
<span id="cb59-108"><a href="async-loading.html#cb59-108" aria-hidden="true" tabindex="-1"></a>      <span class="fu">leafletProxy</span>(<span class="st">&quot;map&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb59-109"><a href="async-loading.html#cb59-109" aria-hidden="true" tabindex="-1"></a>        <span class="fu">addPolygons</span>(</span>
<span id="cb59-110"><a href="async-loading.html#cb59-110" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>sa_polygons,</span>
<span id="cb59-111"><a href="async-loading.html#cb59-111" aria-hidden="true" tabindex="-1"></a>          <span class="at">fillColor=</span><span class="st">&quot;Orange&quot;</span>,</span>
<span id="cb59-112"><a href="async-loading.html#cb59-112" aria-hidden="true" tabindex="-1"></a>          <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb59-113"><a href="async-loading.html#cb59-113" aria-hidden="true" tabindex="-1"></a>          <span class="at">weight=</span><span class="dv">1</span>,</span>
<span id="cb59-114"><a href="async-loading.html#cb59-114" aria-hidden="true" tabindex="-1"></a>          <span class="at">group=</span><span class="st">&quot;Polygons&quot;</span></span>
<span id="cb59-115"><a href="async-loading.html#cb59-115" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb59-116"><a href="async-loading.html#cb59-116" aria-hidden="true" tabindex="-1"></a>      <span class="fu">hide</span>(<span class="st">&quot;loadingScreen&quot;</span>)</span>
<span id="cb59-117"><a href="async-loading.html#cb59-117" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">isolate</span>(rvs<span class="sc">$</span>map_complete)) rvs<span class="sc">$</span>map_complete <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb59-118"><a href="async-loading.html#cb59-118" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb59-119"><a href="async-loading.html#cb59-119" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-120"><a href="async-loading.html#cb59-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-121"><a href="async-loading.html#cb59-121" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="async-loading.html#cb60-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">&quot;RWParsons/interactive-maps&quot;</span>, <span class="at">subdir=</span><span class="st">&quot;input/apps/07-async-load-3/&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="iTRAQI-tricks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="leaflet-colours.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/RWParsons/interactive-maps/edit/master/05-loading.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["interactive-maps.pdf", "interactive-maps.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
