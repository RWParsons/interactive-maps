<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Using a leaflet palette in ggplot | Interactive maps with leaflet</title>
  <meta name="description" content="This is a guide on how to make interactive maps for shiny apps with leaflet. It covers the methods used to developed the iTRAQI app." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Using a leaflet palette in ggplot | Interactive maps with leaflet" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a guide on how to make interactive maps for shiny apps with leaflet. It covers the methods used to developed the iTRAQI app." />
  <meta name="github-repo" content="RWParsons/interactive-maps" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Using a leaflet palette in ggplot | Interactive maps with leaflet" />
  
  <meta name="twitter:description" content="This is a guide on how to make interactive maps for shiny apps with leaflet. It covers the methods used to developed the iTRAQI app." />
  

<meta name="author" content="Rex Parsons" />


<meta name="date" content="2022-08-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="leaflet-colours.html"/>
<link rel="next" href="shiny-colours.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Interactive maps</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#suggested-citation"><i class="fa fa-check"></i>Suggested citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#author-affiliations"><i class="fa fa-check"></i>Author affiliations</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#leaflet-layers"><i class="fa fa-check"></i><b>1.1</b> leaflet layers</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="building.html"><a href="building.html"><i class="fa fa-check"></i><b>2</b> Creating the layers</a>
<ul>
<li class="chapter" data-level="2.1" data-path="building.html"><a href="building.html#kriging"><i class="fa fa-check"></i><b>2.1</b> Kriging</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="building.html"><a href="building.html#data"><i class="fa fa-check"></i><b>2.1.1</b> Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="building.html"><a href="building.html#making-a-grid-of-values-for-interpolation"><i class="fa fa-check"></i><b>2.1.2</b> Making a grid of values for interpolation</a></li>
<li class="chapter" data-level="2.1.3" data-path="building.html"><a href="building.html#kriging-finally"><i class="fa fa-check"></i><b>2.1.3</b> Kriging (finally)</a></li>
<li class="chapter" data-level="2.1.4" data-path="building.html"><a href="building.html#making-rasters"><i class="fa fa-check"></i><b>2.1.4</b> Making rasters</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="building.html"><a href="building.html#polygons"><i class="fa fa-check"></i><b>2.2</b> Polygons</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="building.html"><a href="building.html#dissolving-polygons-to-get-sa2s-and-sa3s"><i class="fa fa-check"></i><b>2.2.1</b> Dissolving polygons to get SA2s and SA3s</a></li>
<li class="chapter" data-level="2.2.2" data-path="building.html"><a href="building.html#simplifying-polygons-to-reduce-rendering-time-with-leaflet"><i class="fa fa-check"></i><b>2.2.2</b> Simplifying polygons to reduce rendering time with leaflet</a></li>
<li class="chapter" data-level="2.2.3" data-path="building.html"><a href="building.html#spatial-joins-and-aggregations"><i class="fa fa-check"></i><b>2.2.3</b> Spatial joins and aggregations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="shiny-intro.html"><a href="shiny-intro.html"><i class="fa fa-check"></i><b>3</b> An app with a map</a>
<ul>
<li class="chapter" data-level="3.1" data-path="shiny-intro.html"><a href="shiny-intro.html#a-bare-bones-shiny-app"><i class="fa fa-check"></i><b>3.1</b> A bare bones shiny app</a></li>
<li class="chapter" data-level="3.2" data-path="shiny-intro.html"><a href="shiny-intro.html#leaflet-maps-in-shiny"><i class="fa fa-check"></i><b>3.2</b> Leaflet maps in shiny</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="shiny-intro.html"><a href="shiny-intro.html#filling-the-space"><i class="fa fa-check"></i><b>3.2.1</b> Filling the space</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="shiny-intro.html"><a href="shiny-intro.html#leaflet-vs-shiny-interactivity"><i class="fa fa-check"></i><b>3.3</b> Leaflet vs shiny interactivity</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="iTRAQI-tricks.html"><a href="iTRAQI-tricks.html"><i class="fa fa-check"></i><b>4</b> iTRAQI tricks</a></li>
<li class="chapter" data-level="5" data-path="async-loading.html"><a href="async-loading.html"><i class="fa fa-check"></i><b>5</b> Asynchronous loading and distracting your user</a>
<ul>
<li class="chapter" data-level="5.1" data-path="async-loading.html"><a href="async-loading.html#distracting-your-user"><i class="fa fa-check"></i><b>5.1</b> Distracting your user</a></li>
<li class="chapter" data-level="5.2" data-path="async-loading.html"><a href="async-loading.html#asynchronous-loading"><i class="fa fa-check"></i><b>5.2</b> Asynchronous loading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="leaflet-colours.html"><a href="leaflet-colours.html"><i class="fa fa-check"></i><b>6</b> Colours with leaflet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="leaflet-colours.html"><a href="leaflet-colours.html#colour-scales-with-leaflet"><i class="fa fa-check"></i><b>6.1</b> Colour scales with leaflet</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="leaflet-colours.html"><a href="leaflet-colours.html#palettes-for-discrete-variables"><i class="fa fa-check"></i><b>6.1.1</b> Palettes for discrete variables</a></li>
<li class="chapter" data-level="6.1.2" data-path="leaflet-colours.html"><a href="leaflet-colours.html#palettes-for-continuous-variables"><i class="fa fa-check"></i><b>6.1.2</b> Palettes for continuous variables</a></li>
<li class="chapter" data-level="6.1.3" data-path="leaflet-colours.html"><a href="leaflet-colours.html#a-mix-of-continuous-and-discrete-colour-scales"><i class="fa fa-check"></i><b>6.1.3</b> A mix of continuous and discrete colour scales</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="leaflet-colours.html"><a href="leaflet-colours.html#legends-with-leaflet"><i class="fa fa-check"></i><b>6.2</b> Legends with leaflet</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html"><i class="fa fa-check"></i><b>7</b> Using a leaflet palette in ggplot</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html#basic-scatterplot-with-ggplot2"><i class="fa fa-check"></i><b>7.1</b> Basic scatterplot with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="7.2" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html#colouring-the-scatterplot-with-the-itraqi-colours"><i class="fa fa-check"></i><b>7.2</b> Colouring the scatterplot with the iTRAQI colours</a></li>
<li class="chapter" data-level="7.3" data-path="ggplot2-colours.html"><a href="ggplot2-colours.html#colouring-the-scatterplot-with-our-custom-palettes-colours"><i class="fa fa-check"></i><b>7.3</b> Colouring the scatterplot with our custom-palette’s colours</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="shiny-colours.html"><a href="shiny-colours.html"><i class="fa fa-check"></i><b>8</b> Getting your map layers and colours communicating</a>
<ul>
<li class="chapter" data-level="8.1" data-path="shiny-colours.html"><a href="shiny-colours.html#leafletcontrol"><i class="fa fa-check"></i><b>8.1</b> <code>leafletControl()</code></a></li>
<li class="chapter" data-level="8.2" data-path="shiny-colours.html"><a href="shiny-colours.html#shiny-inputs-to-select-layers"><i class="fa fa-check"></i><b>8.2</b> shiny inputs to select layers</a></li>
<li class="chapter" data-level="8.3" data-path="shiny-colours.html"><a href="shiny-colours.html#updating-a-shapes-aesthetic."><i class="fa fa-check"></i><b>8.3</b> Updating a shape’s aesthetic.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive maps with leaflet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2-colours" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Using a leaflet palette in ggplot<a href="ggplot2-colours.html#ggplot2-colours" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter will cover:</p>
<ul>
<li>matching <code>ggplot2</code> colour scales to the leaflet colour palettes with:
<ul>
<li>continuous colour scales</li>
<li>binned colour scales</li>
</ul></li>
</ul>
<p>For these examples, we will use the polygons from iTRAQI and be manipulating the ggplot colour palettes as the app does to create the scatter plot on the main map (available when any SA1 or SA2 layer is selected).</p>
<p>The following chunk downloads these layers and colour palettes (just the same as in chapters <a href="intro.html#intro">1</a> and (leaflet-colours) but using SA1s this time).</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="ggplot2-colours.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb90-2"><a href="ggplot2-colours.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb90-3"><a href="ggplot2-colours.html#cb90-3" aria-hidden="true" tabindex="-1"></a>download_layer <span class="ot">&lt;-</span> <span class="cf">function</span>(layer_name, <span class="at">save_dir =</span> <span class="st">&quot;input&quot;</span>) {</span>
<span id="cb90-4"><a href="ggplot2-colours.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  githubURL <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;https://raw.githubusercontent.com/RWParsons/iTRAQI_app/main/input/layers/{layer_name}&quot;</span>)</span>
<span id="cb90-5"><a href="ggplot2-colours.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(githubURL, <span class="fu">file.path</span>(save_dir, layer_name), <span class="at">method =</span> <span class="st">&quot;curl&quot;</span>)</span>
<span id="cb90-6"><a href="ggplot2-colours.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="fu">file.path</span>(save_dir, layer_name))</span>
<span id="cb90-7"><a href="ggplot2-colours.html#cb90-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-8"><a href="ggplot2-colours.html#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="ggplot2-colours.html#cb90-9" aria-hidden="true" tabindex="-1"></a>polygons_layer <span class="ot">&lt;-</span> <span class="fu">download_layer</span>(<span class="st">&quot;stacked_SA1_and_SA2_polygons_year2016_simplified.rds&quot;</span>)</span></code></pre></div>
<p>Before we start, we will load our polygons and palettes from the last chapter:</p>
<p>Here, we create the same palette we used for the leaflet map, the same way as we did in the previous chapter.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="ggplot2-colours.html#cb91-1" aria-hidden="true" tabindex="-1"></a>iTRAQI_acute_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="cn">Inf</span>)</span>
<span id="cb91-2"><a href="ggplot2-colours.html#cb91-2" aria-hidden="true" tabindex="-1"></a>iTRAQI_rehab_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="cn">Inf</span>)</span>
<span id="cb91-3"><a href="ggplot2-colours.html#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="ggplot2-colours.html#cb91-4" aria-hidden="true" tabindex="-1"></a>get_iTRAQI_index <span class="ot">&lt;-</span> <span class="cf">function</span>(acute_mins, rehab_mins) {</span>
<span id="cb91-5"><a href="ggplot2-colours.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  acute_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(acute_mins <span class="sc">/</span> <span class="dv">60</span>, <span class="at">breaks =</span> iTRAQI_acute_breaks)</span>
<span id="cb91-6"><a href="ggplot2-colours.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  rehab_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(rehab_mins <span class="sc">/</span> <span class="dv">60</span>, <span class="at">breaks =</span> iTRAQI_rehab_breaks)</span>
<span id="cb91-7"><a href="ggplot2-colours.html#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="ggplot2-colours.html#cb91-8" aria-hidden="true" tabindex="-1"></a>  acute_label <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(acute_cat)</span>
<span id="cb91-9"><a href="ggplot2-colours.html#cb91-9" aria-hidden="true" tabindex="-1"></a>  rehab_label <span class="ot">&lt;-</span> LETTERS[rehab_cat]</span>
<span id="cb91-10"><a href="ggplot2-colours.html#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="ggplot2-colours.html#cb91-11" aria-hidden="true" tabindex="-1"></a>  index_value <span class="ot">&lt;-</span> <span class="fu">paste0</span>(acute_label, rehab_label)</span>
<span id="cb91-12"><a href="ggplot2-colours.html#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(index_value <span class="sc">==</span> <span class="st">&quot;NANA&quot;</span>, <span class="cn">NA</span>, index_value)</span>
<span id="cb91-13"><a href="ggplot2-colours.html#cb91-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-14"><a href="ggplot2-colours.html#cb91-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-15"><a href="ggplot2-colours.html#cb91-15" aria-hidden="true" tabindex="-1"></a>polygons_layer <span class="ot">&lt;-</span> polygons_layer <span class="sc">%&gt;%</span></span>
<span id="cb91-16"><a href="ggplot2-colours.html#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">get_iTRAQI_index</span>(value_acute, value_rehab))</span>
<span id="cb91-17"><a href="ggplot2-colours.html#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="ggplot2-colours.html#cb91-18" aria-hidden="true" tabindex="-1"></a>qld_SA1s <span class="ot">&lt;-</span> <span class="fu">filter</span>(polygons_layer, SA_level <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb91-19"><a href="ggplot2-colours.html#cb91-19" aria-hidden="true" tabindex="-1"></a>qld_SA1s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(qld_SA1s) <span class="sc">%&gt;%</span></span>
<span id="cb91-20"><a href="ggplot2-colours.html#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CODE, value_acute, value_rehab, index) <span class="sc">%&gt;%</span></span>
<span id="cb91-21"><a href="ggplot2-colours.html#cb91-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb91-22"><a href="ggplot2-colours.html#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="ggplot2-colours.html#cb91-23" aria-hidden="true" tabindex="-1"></a>index_palette_url <span class="ot">&lt;-</span> RCurl<span class="sc">::</span><span class="fu">getURL</span>(<span class="st">&quot;https://raw.githubusercontent.com/RWParsons/iTRAQI_app/main/input/index_palette.csv&quot;</span>)</span>
<span id="cb91-24"><a href="ggplot2-colours.html#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="ggplot2-colours.html#cb91-25" aria-hidden="true" tabindex="-1"></a>index_palette <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> index_palette_url) <span class="sc">%&gt;%</span></span>
<span id="cb91-26"><a href="ggplot2-colours.html#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Acute, Rehab, <span class="at">hex =</span> hex2) <span class="sc">%&gt;%</span></span>
<span id="cb91-27"><a href="ggplot2-colours.html#cb91-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(., <span class="at">iTRAQI_bins =</span> (<span class="fu">na.omit</span>(<span class="fu">unique</span>(polygons_layer<span class="sc">$</span>index)) <span class="sc">%&gt;%</span> <span class="fu">sort</span>()))</span>
<span id="cb91-28"><a href="ggplot2-colours.html#cb91-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-29"><a href="ggplot2-colours.html#cb91-29" aria-hidden="true" tabindex="-1"></a>paliTRAQI <span class="ot">&lt;-</span> <span class="fu">colorFactor</span>(</span>
<span id="cb91-30"><a href="ggplot2-colours.html#cb91-30" aria-hidden="true" tabindex="-1"></a>  index_palette<span class="sc">$</span>hex,</span>
<span id="cb91-31"><a href="ggplot2-colours.html#cb91-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> index_palette<span class="sc">$</span>iTRAQI_bins,</span>
<span id="cb91-32"><a href="ggplot2-colours.html#cb91-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="cn">FALSE</span></span>
<span id="cb91-33"><a href="ggplot2-colours.html#cb91-33" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="basic-scatterplot-with-ggplot2" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Basic scatterplot with <code>{ggplot2}</code><a href="ggplot2-colours.html#basic-scatterplot-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here’s our starting point. An uncoloured scatter plot of rehab and acute travel times for each SA2 area</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="ggplot2-colours.html#cb92-1" aria-hidden="true" tabindex="-1"></a>qld_SA1s_df <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="ggplot2-colours.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value_rehab, value_acute)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="ggplot2-colours.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="ggplot2-colours.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb92-5"><a href="ggplot2-colours.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb92-6"><a href="ggplot2-colours.html#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Acute time (minutes)&quot;</span>,</span>
<span id="cb92-7"><a href="ggplot2-colours.html#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Rehab time (minutes)&quot;</span></span>
<span id="cb92-8"><a href="ggplot2-colours.html#cb92-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb92-9"><a href="ggplot2-colours.html#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb92-10"><a href="ggplot2-colours.html#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="at">by =</span> <span class="dv">120</span>))</span></code></pre></div>
<p><img src="interactive-maps_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="colouring-the-scatterplot-with-the-itraqi-colours" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Colouring the scatterplot with the iTRAQI colours<a href="ggplot2-colours.html#colouring-the-scatterplot-with-the-itraqi-colours" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we add the index to the colour aesthetic, we get the desired effect in the plot, but not to the colour palette we have on the main map.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="ggplot2-colours.html#cb93-1" aria-hidden="true" tabindex="-1"></a>qld_SA1s_df <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="ggplot2-colours.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value_rehab, value_acute, <span class="at">col =</span> index)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="ggplot2-colours.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="ggplot2-colours.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-5"><a href="ggplot2-colours.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb93-6"><a href="ggplot2-colours.html#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Acute time (minutes)&quot;</span>,</span>
<span id="cb93-7"><a href="ggplot2-colours.html#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Rehab time (minutes)&quot;</span></span>
<span id="cb93-8"><a href="ggplot2-colours.html#cb93-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb93-9"><a href="ggplot2-colours.html#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb93-10"><a href="ggplot2-colours.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="at">by =</span> <span class="dv">120</span>))</span></code></pre></div>
<p><img src="interactive-maps_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>To apply the paliTRAQI colours to the scatter plot, we use <code>scale_colour_manual</code> to manually assign values (hex codes) as well as specifying the limits to include all possible values.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="ggplot2-colours.html#cb94-1" aria-hidden="true" tabindex="-1"></a>qld_SA1s_df <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="ggplot2-colours.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value_rehab, value_acute, <span class="at">col =</span> index)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="ggplot2-colours.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="ggplot2-colours.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb94-5"><a href="ggplot2-colours.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb94-6"><a href="ggplot2-colours.html#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Acute time (minutes)&quot;</span>,</span>
<span id="cb94-7"><a href="ggplot2-colours.html#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Rehab time (minutes)&quot;</span></span>
<span id="cb94-8"><a href="ggplot2-colours.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb94-9"><a href="ggplot2-colours.html#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb94-10"><a href="ggplot2-colours.html#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="at">by =</span> <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb94-11"><a href="ggplot2-colours.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb94-12"><a href="ggplot2-colours.html#cb94-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paliTRAQI</span>(index_palette<span class="sc">$</span>iTRAQI_bins),</span>
<span id="cb94-13"><a href="ggplot2-colours.html#cb94-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> index_palette<span class="sc">$</span>iTRAQI_bins</span>
<span id="cb94-14"><a href="ggplot2-colours.html#cb94-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="interactive-maps_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="colouring-the-scatterplot-with-our-custom-palettes-colours" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Colouring the scatterplot with our custom-palette’s colours<a href="ggplot2-colours.html#colouring-the-scatterplot-with-our-custom-palettes-colours" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we load the palette that we used for the leaflet map with unevenly spaced bins</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="ggplot2-colours.html#cb95-1" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">240</span>, <span class="dv">300</span>, <span class="dv">360</span>, <span class="dv">900</span>, <span class="dv">1200</span>)</span>
<span id="cb95-2"><a href="ggplot2-colours.html#cb95-2" aria-hidden="true" tabindex="-1"></a>palBin <span class="ot">&lt;-</span> <span class="fu">colorBin</span>(<span class="st">&quot;YlOrRd&quot;</span>, <span class="at">domain =</span> <span class="fu">min</span>(bins)<span class="sc">:</span><span class="fu">max</span>(bins), <span class="at">bins =</span> bins, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-3"><a href="ggplot2-colours.html#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="ggplot2-colours.html#cb95-4" aria-hidden="true" tabindex="-1"></a>palNum1 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">1</span>]), <span class="fu">palBin</span>(bins[<span class="dv">2</span>])), <span class="at">domain =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-5"><a href="ggplot2-colours.html#cb95-5" aria-hidden="true" tabindex="-1"></a>palNum2 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">2</span>]), <span class="fu">palBin</span>(bins[<span class="dv">3</span>])), <span class="at">domain =</span> <span class="dv">30</span><span class="sc">:</span><span class="dv">60</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-6"><a href="ggplot2-colours.html#cb95-6" aria-hidden="true" tabindex="-1"></a>palNum3 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">3</span>]), <span class="fu">palBin</span>(bins[<span class="dv">4</span>])), <span class="at">domain =</span> <span class="dv">60</span><span class="sc">:</span><span class="dv">120</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-7"><a href="ggplot2-colours.html#cb95-7" aria-hidden="true" tabindex="-1"></a>palNum4 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">4</span>]), <span class="fu">palBin</span>(bins[<span class="dv">5</span>])), <span class="at">domain =</span> <span class="dv">120</span><span class="sc">:</span><span class="dv">180</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-8"><a href="ggplot2-colours.html#cb95-8" aria-hidden="true" tabindex="-1"></a>palNum5 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">5</span>]), <span class="fu">palBin</span>(bins[<span class="dv">6</span>])), <span class="at">domain =</span> <span class="dv">180</span><span class="sc">:</span><span class="dv">240</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-9"><a href="ggplot2-colours.html#cb95-9" aria-hidden="true" tabindex="-1"></a>palNum6 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">6</span>]), <span class="fu">palBin</span>(bins[<span class="dv">7</span>])), <span class="at">domain =</span> <span class="dv">240</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-10"><a href="ggplot2-colours.html#cb95-10" aria-hidden="true" tabindex="-1"></a>palNum7 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">7</span>]), <span class="fu">palBin</span>(bins[<span class="dv">8</span>])), <span class="at">domain =</span> <span class="dv">300</span><span class="sc">:</span><span class="dv">360</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-11"><a href="ggplot2-colours.html#cb95-11" aria-hidden="true" tabindex="-1"></a>palNum8 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">8</span>]), <span class="fu">palBin</span>(bins[<span class="dv">9</span>])), <span class="at">domain =</span> <span class="dv">360</span><span class="sc">:</span><span class="dv">900</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-12"><a href="ggplot2-colours.html#cb95-12" aria-hidden="true" tabindex="-1"></a>palNum9 <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="fu">c</span>(<span class="fu">palBin</span>(bins[<span class="dv">9</span>]), <span class="st">&quot;#000000&quot;</span>), <span class="at">domain =</span> <span class="dv">900</span><span class="sc">:</span><span class="dv">1200</span>, <span class="at">na.color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb95-13"><a href="ggplot2-colours.html#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="ggplot2-colours.html#cb95-14" aria-hidden="true" tabindex="-1"></a>palNumMix <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb95-15"><a href="ggplot2-colours.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb95-16"><a href="ggplot2-colours.html#cb95-16" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="fu">palNum1</span>(x),</span>
<span id="cb95-17"><a href="ggplot2-colours.html#cb95-17" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="fu">palNum2</span>(x),</span>
<span id="cb95-18"><a href="ggplot2-colours.html#cb95-18" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="fu">palNum3</span>(x),</span>
<span id="cb95-19"><a href="ggplot2-colours.html#cb95-19" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">~</span> <span class="fu">palNum4</span>(x),</span>
<span id="cb95-20"><a href="ggplot2-colours.html#cb95-20" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">240</span> <span class="sc">~</span> <span class="fu">palNum5</span>(x),</span>
<span id="cb95-21"><a href="ggplot2-colours.html#cb95-21" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">300</span> <span class="sc">~</span> <span class="fu">palNum6</span>(x),</span>
<span id="cb95-22"><a href="ggplot2-colours.html#cb95-22" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">360</span> <span class="sc">~</span> <span class="fu">palNum7</span>(x),</span>
<span id="cb95-23"><a href="ggplot2-colours.html#cb95-23" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">900</span> <span class="sc">~</span> <span class="fu">palNum8</span>(x),</span>
<span id="cb95-24"><a href="ggplot2-colours.html#cb95-24" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&lt;</span> <span class="dv">1200</span> <span class="sc">~</span> <span class="fu">palNum9</span>(x),</span>
<span id="cb95-25"><a href="ggplot2-colours.html#cb95-25" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&gt;=</span> <span class="dv">1200</span> <span class="sc">~</span> <span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb95-26"><a href="ggplot2-colours.html#cb95-26" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;transparent&quot;</span></span>
<span id="cb95-27"><a href="ggplot2-colours.html#cb95-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-28"><a href="ggplot2-colours.html#cb95-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To colour the points to the <code>palNumMix</code> palette, we need to use <code>scale_colour_gradientn()</code>.</p>
<p>The tricky bit to apply in the app here, is to be able to create the this colour scale for either the acute or rehab time. Here, I’ll declare these as arguments so the generating of the colour scale is closer to how it’s done in the app.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="ggplot2-colours.html#cb96-1" aria-hidden="true" tabindex="-1"></a>care_type_selected <span class="ot">&lt;-</span> <span class="st">&quot;value_acute&quot;</span></span>
<span id="cb96-2"><a href="ggplot2-colours.html#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="ggplot2-colours.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (care_type_selected <span class="sc">==</span> <span class="st">&quot;value_acute&quot;</span>) {</span>
<span id="cb96-4"><a href="ggplot2-colours.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  df_plot <span class="ot">&lt;-</span></span>
<span id="cb96-5"><a href="ggplot2-colours.html#cb96-5" aria-hidden="true" tabindex="-1"></a>    qld_SA1s_df <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="ggplot2-colours.html#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">selected_col =</span> value_acute)</span>
<span id="cb96-7"><a href="ggplot2-colours.html#cb96-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (care_type_selected <span class="sc">==</span> <span class="st">&quot;value_rehab&quot;</span>) {</span>
<span id="cb96-8"><a href="ggplot2-colours.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  df_plot <span class="ot">&lt;-</span></span>
<span id="cb96-9"><a href="ggplot2-colours.html#cb96-9" aria-hidden="true" tabindex="-1"></a>    qld_SA1s_df <span class="sc">%&gt;%</span></span>
<span id="cb96-10"><a href="ggplot2-colours.html#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">selected_col =</span> value_rehab)</span>
<span id="cb96-11"><a href="ggplot2-colours.html#cb96-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-12"><a href="ggplot2-colours.html#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="ggplot2-colours.html#cb96-13" aria-hidden="true" tabindex="-1"></a>minimum <span class="ot">&lt;-</span> <span class="fu">min</span>(df_plot<span class="sc">$</span>selected_col, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-14"><a href="ggplot2-colours.html#cb96-14" aria-hidden="true" tabindex="-1"></a>maximum <span class="ot">&lt;-</span> <span class="fu">max</span>(df_plot<span class="sc">$</span>selected_col, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-15"><a href="ggplot2-colours.html#cb96-15" aria-hidden="true" tabindex="-1"></a>col_bins <span class="ot">&lt;-</span> <span class="fu">c</span>(minimum, bins[(bins <span class="sc">&gt;</span> minimum <span class="sc">&amp;</span> bins <span class="sc">&lt;</span> maximum)], maximum)</span>
<span id="cb96-16"><a href="ggplot2-colours.html#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="ggplot2-colours.html#cb96-17" aria-hidden="true" tabindex="-1"></a>df_plot <span class="sc">%&gt;%</span></span>
<span id="cb96-18"><a href="ggplot2-colours.html#cb96-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value_rehab, value_acute, <span class="at">col =</span> selected_col)) <span class="sc">+</span></span>
<span id="cb96-19"><a href="ggplot2-colours.html#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb96-20"><a href="ggplot2-colours.html#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-21"><a href="ggplot2-colours.html#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-22"><a href="ggplot2-colours.html#cb96-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Acute time (minutes)&quot;</span>,</span>
<span id="cb96-23"><a href="ggplot2-colours.html#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Rehab time (minutes)&quot;</span></span>
<span id="cb96-24"><a href="ggplot2-colours.html#cb96-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-25"><a href="ggplot2-colours.html#cb96-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb96-26"><a href="ggplot2-colours.html#cb96-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="at">by =</span> <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb96-27"><a href="ggplot2-colours.html#cb96-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradientn</span>(</span>
<span id="cb96-28"><a href="ggplot2-colours.html#cb96-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">colours =</span> <span class="fu">palNumMix</span>(col_bins),</span>
<span id="cb96-29"><a href="ggplot2-colours.html#cb96-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(col_bins)</span>
<span id="cb96-30"><a href="ggplot2-colours.html#cb96-30" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="interactive-maps_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>If we change the first line in the chunk above to be:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="ggplot2-colours.html#cb97-1" aria-hidden="true" tabindex="-1"></a>care_type_selected <span class="ot">&lt;-</span> <span class="st">&quot;value_rehab&quot;</span></span></code></pre></div>
<p>The plot changes to be colour the points according to the rehab time, and using the same scale.</p>
<p><img src="interactive-maps_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>This is implemented in the iTRAQI app in a nifty way that allows the user’s selection of the layer to trigger both changes on the map and the associated plot. There’s also an additional feature of removing points on the plot (but actually only setting <code>alpha=0</code>) that are filtered out using the filters on the control panel. We also don’t bother showing the legend on the plot because this would be replicating the legend made for leaflet. How these systems interact will be described in Chapter (shiny-colours)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="leaflet-colours.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="shiny-colours.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/RWParsons/interactive-maps/edit/master/07-ggplot2-colours.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["interactive-maps.pdf", "interactive-maps.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
